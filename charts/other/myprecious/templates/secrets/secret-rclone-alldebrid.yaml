{{ if .Values.rclonemountalldebrid.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Release.Name }}-alldebrid
  namespace: csi-rclone
type: Opaque
stringData:
  remote: alldebrid-{{ .Release.Name }}
  remotePath: # intentionally left blank, webdav doesn't need it
  # allow-non-empty: "true"
  # allow-other: "true"
  uid: "568"
  gid: "568" 
  vfs-cache-max-size: 10G

  # Apparently these are optimal settings per https://help.alldebrid.com/en/faq/rclone-webdav
  vfs-cache-mode: minimal
  multi-thread-streams: 0 
  buffer-size: "0"
  read-only: "true"
  dir-cache-time: 10s

  configData: |
    [alldebrid-{{ .Release.Name }}]
    type = webdav
    url: https://webdav.debrid.it/
    user: {{ .Values.rclonemountalldebrid.apikey }}
    pass: {{ .Values.rclonemountalldebrid.password }}    
    vendor = other
    pacer_min_sleep = 0    
{{ end }}