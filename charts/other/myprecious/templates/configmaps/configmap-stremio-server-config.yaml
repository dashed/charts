{{ if .Values.stremioserver.enabled }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: stremio-server-config
data:
  server-settings.json: |
    {
        "serverVersion": "4.20.8",
        "appPath": "/config",
        "cacheRoot": "/transcode",
        "cacheSize": 2147483648,
        "btMaxConnections": 55,
        "btHandshakeTimeout": 20000,
        "btRequestTimeout": 4000,
        "btDownloadSpeedSoftLimit": 2621440,
        "btDownloadSpeedHardLimit": 3670016,
        "btMinPeersForStable": 5,
        "localAddonEnabled": false,
        "transcodeHorsepower": 0.75,
        "transcodeMaxBitRate": 0,
        "transcodeConcurrency": 1,
        "transcodeTrackConcurrency": 1,
        "transcodeHardwareAccel": true,
        "transcodeProfile": "vaapi-renderD128",
        "transcodeMaxWidth": 1920,
        "remoteHttps": "{{ .Release.Name }}-stremio-server-{{ .Values.stremioserver.token }}.elfhosted.com",
        "allTranscodeProfiles": [
            "qsv-linux",
            "vaapi-renderD128"
        ]
    }
{{ end }}